# Code2fodt

Скрипт для компактного архивирования исходников
в&nbsp;человекочитаемой форме
с&nbsp;помощью обыкновенного принтера.

Вдохновлено [Arctic Code Vault](https://archiveprogram.github.com/arctic-vault/).

Требования:

* Git-репозиторий.
  * Программа печатает только tracked файлы.
  * У&nbsp;бинарных файлов печатается только размер в&nbsp;байтах и&nbsp;MD5.
* Желательна кодировка UTF-8, хотя другие кодировки иногда тоже могут распечатываться правильно.
* ПО:
  * Git
  * File (реализация, поддерживающая `--mime-encoding`)
  * OpenOffice / LibreOffice
  * Можно валидировать сгенерированный XML с&nbsp;помощью xmlstarlet:
    ```
    sudo apt-get install xmlstarlet
    xmlstarlet val out.fodt
    ```
  * В случае, если файл не&nbsp;читается, можно найти конкретные ошибки в&nbsp;XML.
    ```
    sudo apt-get install libxml2-utils
    xmllint out.fodt
    ```
  * Можно использовать AbiWord для распечатки больших документов,
    с&nbsp;которыми OpenOffice не&nbsp;справляется.
    Abiword поддерживает ODT. Вот так можно сконвертировать FODT в ODT:
    ```
    libreoffice --headless --convert-to odt out.fodt
    ```
    Эта операция медленная и&nbsp;жадная до&nbsp;оперативной памяти.
    Еще в&nbsp;AbiWord может немного отличаться форматирование.
    Чтобы распечатывать напрямую из&nbsp;OpenOffice, можно
    разбить вывод на&nbsp;большее количество томов параметром `--volume-loc-threshold`
    (число строк в&nbsp;одном томе).
    Нумерация страниц в&nbsp;каждом томе начинается с&nbsp;единицы.
* Надежный носитель. Например:
  * [Бескислотная бумага ♾](https://en.wikipedia.org/wiki/Acid-free_paper) из&nbsp;древесного сырья&nbsp;—
  после полного намокания,
  *если она не&nbsp;порвётся в&nbsp;намокшем виде,*
  после высыхания она останется лишь немного деформированной.
  Тем не&nbsp;менее, я&nbsp;не&nbsp;могу гарантировать, что
  книга из&nbsp;такой бумаги сможет пережить потоп не&nbsp;слипнувшись.
  Тестировал слипание двух листов.
  Полностью пропитывал их водой и&nbsp;оставлял соединенными до&nbsp;полного высыхания
  в&nbsp;горизонтальном положении при комнатной температуре, ничем не&nbsp;прижимая.
  Листы не&nbsp;слиплись, но после неоднократного намокания и&nbsp;высыхания
  бумага становится немного ворсистой на&nbsp;микроуровне, чернила немного стираются. 
  Бескислотная бумага не&nbsp;только хорошо переносит воду, но также
  медленнее разрушается от&nbsp;света и&nbsp;тепла.
  Стандарты:
    * [ISO 9706](https://www.iso.org/standard/17562.html).
      Не&nbsp;могу ручаться за&nbsp;точность,
      [но&nbsp;есть сведения](https://www.klug-conservation.com/medien/Wissen/Wissens_Folder/wissen8_blauer_engel_en.pdf), что стандарт несовместим
      с&nbsp;бумагой, произведенной из&nbsp;вторсырья, т.к.
      от&nbsp;нее нельзя ожидать требуемой прочности.
    * [ГОСТ Р ИСО 9706-2000](https://internet-law.ru/gosts/gost/10997/) —
    российский аналог ISO&nbsp;9706.
    Сейчас интернет-магазины обычно не&nbsp;указывают этот стандарт в&nbsp;фильтрах.
    Однако найти ее в&nbsp;продаже через поисковики всё-таки можно. 
      * Не&nbsp;путать с&nbsp;ГОСТ&nbsp;Р&nbsp;57641-2017&nbsp;— про размеры,
        впитываемость при одностороннем смачивании, требования к&nbsp;упаковке.
        Самые жёсткие ограничения к&nbsp;впитываемости&nbsp;—
        у&nbsp;бумаги марки&nbsp;А (не&nbsp;более 40&nbsp;г/м²).
      * Не&nbsp;путать с&nbsp;ГОСТ&nbsp;Р&nbsp;ИСО 9001-2015&nbsp;—
        стандарт клиентоориентированности организации.
  * Архивная/музейная бумага для очень важных документов.
  Например, 100% хлопковая бумага, устойчивая не&nbsp;только к&nbsp;воде, но и к&nbsp;механическому истиранию.
  Не&nbsp;знаю, совместима&nbsp;ли она вообще с&nbsp;принтерами.
  Видел в&nbsp;продаже только в&nbsp;зарубежных интернет-магазинах.
  Стандарты:
    * [ISO 11108](https://www.iso.org/standard/1708.html)
  * Бумага, протестированная с&nbsp;помощью ускоренного состаривания
  в&nbsp;течение всего-лишь десятков дней.
  Это альтернативный способ определения долговечности, полностью игнорирующий
  состав.
    * Немецкий стандарт [DIN 6738](https://blog.stp.de/archive-herausforderung-fuer-papier/)
      определяет несколько классов бумаги. Бумага *LDK&nbsp;24-85* считается устойчивой к&nbsp;старению.
      Я&nbsp;не&nbsp;нашел в&nbsp;описаниях этого стандарта в&nbsp;интернете что-либо связанное с&nbsp;влажностью.
      Похоже, что ускоренное старение&nbsp;— это растяжение, трение, высокая температура.
      Сам стандарт не&nbsp;читал.
    * Стандарт [ISO 20494](https://www.iso.org/standard/68211.html) опирается на&nbsp;ускоренное старение,
      но&nbsp;также определяет допустимый уровень pH
      и&nbsp;минимальное содержание веществ, нейтрализующих воздействие кислот (щелочной резерв).
      Не&nbsp;могу сказать ничего более об&nbsp;этом стандарте,
      т.к. его, похоже, нет в&nbsp;открытом доступе.
  * Ламинирование&nbsp;— еще один способ защиты от&nbsp;воды и&nbsp;механических повреждений.
  Минусы: долго, сложно, утяжеляет размер архива в 2-3 раза.
  * Была идея потестировать прозрачные плёнки (термопленки, не&nbsp;самоклеющиеся).
  Есть пленки A4 для лазерной печати.
  Продаются обычно по 10-50 листов в пачке.
  Значительно дороже бумаги. Довольно большой разброс цен.
  Полиэстр (ПЭТ) лёгкий, тонкий, нерастворим в воде,
  температура плавления&nbsp;— 250&nbsp;°C.
  Может быть токсичен при горении. Менее удобно читать и&nbsp;сканировать.
  * Фотобумага&nbsp;— есть водостойкие виды.
    Фотобумага специально предназначена для длительного хранения.
    Чуть дешевле плёнок. Не прозрачная, белый фон.
    Минусы: скорее всего подходит только для струйной печати;
    намного тяжелее плёнок; может быть менее удобно читать из-за глянца.
  * Синтетическая бумага. Есть марки бумаги, устойчивые к&nbsp;влаге, жиру и&nbsp;грязи,
    предназначенные специально для печати меню, табличек, открыток,
    инструкций, чертежей, бирок, подходящие для цветной лазерной печати.
    Толщина такой бумаги может быть сопоставимой
    с&nbsp;толщиной обычной офисной бумаги (около 100 мкм).
    Судя по&nbsp;описанию, это что-то очень близкое к&nbsp;ПЭТ-пленкам.
* Принтер.
* Увеличительное стекло или сканер, чтобы читать распечатки.
* Скрепление листов.
  * Например, дырокол и папка-регистратор или
  * Настоящий живой переплётчик (переплёт выглядит солидно,
  но если придется в будущем сканировать&nbsp;— это неудобно).


## Насколько это компактно

| Проект                                                   | 2 колонки    | 3 колонки   | 6 колонок    |
| ---------------                                          | ------------ | ----------- | ------------ |
| [Portable C Compiler](https://github.com/OrangeTide/pcc) | 312 страниц  | 138 страниц | 33 страницы  |
| [Ядро Linux](https://github.com/torvalds/linux)          | ~75000 с.    | ~33000 с.   | ~8000 с.     |
| [FreeBSD](https://github.com/freebsd/freebsd-src.git)    | ~82000 с.    | ~36000 с.   | ~8500 с.     |
| Минимальное разрешение                                   | 1200х600 dpi | 1200 dpi    | 2400 dpi     |
| Лупа для чтения                                          | &gt; 7x      | &gt; 10x    | &gt; 20x     |
